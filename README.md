# 社会计算期末作业：基于图神经网络与社会信号增强的金融诈骗检测机制研究

这是我的社会计算课程期末作业。本项目构建了一个基于图神经网络 (GNN) 的金融欺诈检测流程，重点在于合成具有社会学特征（如共谋、设备共享）的数据，并通过 `Player2Vec` 模型进行检测，最后进行全面的实验分析。

## 1. 核心代码与功能说明

本项目包含几个核心脚本，分别负责数据生成、模型训练与分析、以及干预策略模拟。

### 1.1 数据生成 (`generate_synthetic_data.py`)

此脚本负责构建用于实验的合成数据集 `dataset/Synthetic_Financial_Fraud.mat`。它不仅仅是生成随机噪声，而是模拟了真实的欺诈行为模式：

- **用户节点**: 生成 1000 个用户，其中 10% 为欺诈者。
- **特征工程**:
  - **特征伪装 (Camouflage)**: 约 60% 的欺诈者会伪装成正常用户的特征分布，强制模型必须依赖图结构而非单纯的节点特征来识别欺诈。
- **多视图图结构**:
  1. **社交网络 (`net_Social`)**: 使用 Barabasi-Albert 模型生成无标度网络，模拟真实社交关系。
  2. **交易网络 (`net_Transaction`)**: 模拟欺诈团伙的**共谋 (Collusion)** 行为。欺诈者之间形成紧密的环状结构（Cliques），这种高聚集系数是识别欺诈的关键。
  3. **设备网络 (`net_Device`)**: 模拟**设备共享 (Device Farming)**。欺诈者倾向于共享设备，而正常用户通常只有少量设备。

### 1.2 全面实验分析 (`run_comprehensive_analysis.py`)

这是本项目的主实验脚本，负责训练模型并评估其性能。

- **模型**: 使用 `Player2Vec` (一种基于注意力机制的 GNN) 来聚合来自社交、交易和设备三个视图的信息。
- **流程**:
  1. 加载合成数据。
  2. 划分训练集、验证集和测试集。
  3. 训练模型并使用验证集进行早停 (Early Stopping) 以防止过拟合。
  4. 在测试集上评估性能。
- **可视化与评估**:
  - 计算并输出 **测试集准确率 (Test Accuracy)** 和 **损失 (Test Loss)**。
  - 生成 **ROC 曲线** 和 **AUC 指标**，评估模型的分类能力。
  - 绘制 **混淆矩阵 (Confusion Matrix)**，查看误报和漏报情况。
  - 使用 **t-SNE** 对学习到的节点嵌入 (Embeddings) 进行降维可视化，直观展示欺诈者和正常用户在潜在空间中的分离程度。

### 1.3 干预模拟 (`simulate_intervention.py`)

基于训练好的模型和图结构，模拟不同的干预策略对欺诈传播的影响：

- **随机干预**: 随机检查用户。
- **策略干预**: 针对社交网络中度中心性 (Degree Centrality) 最高的节点（社交枢纽）进行检查。实验证明这种策略在资源有限时极其有效。

## 2. 环境配置

- **依赖**: TensorFlow >= 2.0, NumPy < 2.0, SciPy, NetworkX, Matplotlib, Scikit-learn。
- **修复说明**: 代码已针对 TensorFlow 2.x 和 NumPy 新版本进行了适配（如修复 `np.bool` 类型移除问题、Keras 3 兼容性等）。

## 3. 如何运行实验

请按照以下顺序运行脚本以复现实验结果：

### 第一步：生成数据

首先运行生成脚本，构建包含社交、交易和设备图的合成数据。

```bash
python generate_synthetic_data.py
```

*输出*: `dataset/Synthetic_Financial_Fraud.mat`

### 第二步：运行全面分析 (核心实验)

运行此脚本以训练模型并生成所有分析图表。

```bash
python run_comprehensive_analysis.py
```

*输出*: 控制台将显示训练进度和最终准确率。生成的图表（ROC曲线、混淆矩阵、t-SNE可视化）将直接显示或保存。

### 第三步：模拟干预 (扩展实验)

(可选) 运行干预模拟以对比不同策略的效果。

```bash
python simulate_intervention.py
```
